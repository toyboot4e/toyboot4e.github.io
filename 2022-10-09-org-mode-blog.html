<!DOCTYPE html>
<html lang="ja">
<head>
  <meta name="generator" content="HTML Tidy for HTML5 for Apple macOS version 5.8.0">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdn.simplecss.org/simple.min.css">
  <link rel="stylesheet" href="style/style.css">
  <link rel="stylesheet" href="style/prism.css">
  <script src="/style/prism.js" async></script>
  <title>org-mode で簡易ブログ生成 - toybeam</title>
</head>
<body>
  <header role="banner">
    <h1><code>org-mode</code> で簡易ブログ生成</h1>
    <p>Oct 9, 2022</p>
    <nav role="navigation">
      <a href="/">Home</a><a href="https://github.com/toyboot4e">GitHub</a>
    </nav>
  </header>
  <main role="main">
    <p><a href="https://systemcrafters.cc/">System Crafters</a> の投稿を元に <code>org-mode</code> で本ブログを生成しました。</p>
    <p>SSG の主な機能は <code>org-publish</code> にお任せできますが、 HTML 生成は自分でやります。 HTML 生成には <a href="https://github.com/tali713/esxml">esxml</a> (S 式で書く XHTML)
    を使用しました。</p>
    <blockquote>
      <p>本当はミラーボールを回したかったですが、力不足だったようです。</p>
    </blockquote>
    <div id="outline-container-org27f0ff5" class="outline-2">
      <h2 id="org27f0ff5"><a href="#org27f0ff5">使い方</a></h2>
      <div class="outline-text-2" id="text-org27f0ff5">
        <p>ファイル構成は以下です:</p>
        <div class="org-src-container">
          <pre><code class="src language-sh">.
├── build.el   # ビルドスクリプト + ビルド設定 (ELisp)
├── out        # サイト
├── src        # サイトの全ソースファイル
│   ├── img           # 画像ファイル
│   ├── index.org     # 索引 (`org-publish` が自動生成する sitemap)
│   ├── *.org         # 投稿記事
│   ├── *.draft.org   # 下書き (`release` ビルドの際はビルド対象から除外)
│   └── style         # CSS, JS やテンプレート HTML
└── x          # ビルドスクリプトを起動するシェルスクリプト
</code></pre>
        </div>
        <p>コマンドラインから <code>x</code> スクリプトを実行します:</p>
        <ul class="org-ul">
          <li><code>./x release</code> のような形でビルドすると、 <code>out/*.html</code> が生成されます。</li>
          <li><code>./x watch</code> としておけば、 <code>.org</code> ファイルの変更時にリビルドしてくれます。</li>
        </ul>
      </div>
    </div>
    <div id="outline-container-org5727d36" class="outline-2">
      <h2 id="org5727d36"><a href="#org5727d36">主なリソース</a></h2>
      <div class="outline-text-2" id="text-org5727d36">
        <p>もしも <code>org-mode</code> でブログ生成したいという人がいたら、以下のリンクが役に立つかもしれません。</p>
      </div>
      <div id="outline-container-orga501cd9" class="outline-3">
        <h3 id="orga501cd9"><a href="#orga501cd9">入門記事</a></h3>
        <div class="outline-text-3" id="text-orga501cd9">
          <p>公式マニュアルが説明不足なので、チュートリアルが重宝します:</p>
          <ul class="org-ul">
            <li>
              <a href="https://systemcrafters.net/publishing-websites-with-org-mode/building-the-site/">Build Your Website with Org Mode - System
              Crafters</a><br>
              <code>org-publish</code> と <a href="https://simplecss.org">Simple.css</a> で綺麗なブログを作ります。
            </li>
            <li>
              <a href="https://taingram.org/blog/org-mode-blog.html">Building a Emacs Org - Mode Blog</a><br>
              似た内容ですが ELisp の書き方が参考になります。
            </li>
          </ul>
        </div>
      </div>
      <div id="outline-container-orgac862de" class="outline-3">
        <h3 id="orgac862de"><a href="#orgac862de">The Org Manual</a></h3>
        <div class="outline-text-3" id="text-orgac862de">
          <p><a href="https://orgmode.org/org.html">The Org Manual</a> は意外に短くて説明不足の感はあります:</p>
          <ul class="org-ul">
            <li>
              <a href="https://orgmode.org/manual/Exporting.html">13. Exporting</a>
              <ul class="org-ul">
                <li>
                  <a href="https://orgmode.org/manual/Exporting.html">13.9 HTML Export</a><br>
                  ヘッダ生成などのオプションを設定できます。ただし自由度が低いので、自分で HTML テンプレートを書く のが良いと思います。
                </li>
                <li>
                  <a href="https://orgmode.org/manual/Advanced-Export-Configuration.html">13.17 Advanced Export Configuration</a><br>
                  <code>ox-html</code> の HTML テンプレートを差し替えることができます。またフィルタ (Unix フィルタのニュアンス) を使ってコードブロックの HTML 変換などをオーバーライドできることがわかります。
                </li>
              </ul>
            </li>
            <li>
              <a href="https://orgmode.org/manual/Publishing.html">14. Publishing</a><br>
              <code>org-publish</code> のオプションを把握することができます。
            </li>
          </ul>
        </div>
      </div>
      <div id="outline-container-org134995e" class="outline-3">
        <h3 id="org134995e"><a href="#org134995e">HTML 生成の改良</a></h3>
        <div class="outline-text-3" id="text-org134995e">
          <p>HTML 生成をハイジャックすれば完成です:</p>
          <ul class="org-ul">
            <li>
              <a href="https://github.com/SystemCrafters/systemcrafters.github.io/blob/master/publish.el">publish.el (System Crafters website)</a><br>
              <a href="https://github.com/tali713/esxml">esxml</a> を使ったテンプレート HTML を作成します。
            </li>
            <li>
              <a href="https://www.roygbyte.com/add_syntax_highlighting_to_an_org_publish_project.html">Add syntax highlighting to an
              org-publish-project</a><br>
              コードブロックを <a href="https://prismjs.com">Prism.js</a> 対応の HTML に変換するフィルタが載っています。
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div id="outline-container-org5d0a27f" class="outline-2">
      <h2 id="org5d0a27f"><a href="#org5d0a27f">メモ</a></h2>
      <div class="outline-text-2" id="text-org5d0a27f">
        <ul class="org-ul">
          <li>XHTML
            <ul class="org-ul">
              <li>XHTML だと <code>async</code> のようなフラグは書けない (<code>async=""</code> になる)<br>
                <a href="https://stackoverflow.com/a/21800875">https://stackoverflow.com/a/21800875</a>
              </li>
            </ul>
          </li>
          <li>
            <code>org-mode</code>
            <ul class="org-ul">
              <li>
                <a href="https://orgmode.org/manual/Link-Abbreviations.html">Link Abbreviations</a>
              </li>
              <li>Bullet の中に改行を入れたければ、 markdown のように <code>\\</code> を書くしかない</li>
            </ul>
          </li>
          <li>TODOs
            <ul class="org-ul">
              <li class="on">
                <code>[X]</code> <code>&lt;title&gt;</code> タグから <code>&lt;code&gt;</code> タグなどを取り除く → <a href=
                "https://gnu.support/gnu-emacs/emacs-lisp/Emacs-Lisp-strip-html-by-Sacha-Chua-remove-those-tags.html">このコードをコピペ</a>
              </li>
              <li class="on">
                <code>[X]</code> 出力 HTML を整形する → <a href="http://www.html-tidy.org/">tidy</a>
              </li>
              <li class="off"><code>[&nbsp;]</code> <code>index.html</code> をテーブルにする？</li>
              <li class="off"><code>[&nbsp;]</code> <code>index.html</code> でミラーボールを回す</li>
            </ul>
          </li>
        </ul>
      </div>
    </div>
  </main>
  <footer role="contentinfo">
    <p>Styled with <a href="https://simplecss.org/">Simple.css</a></p>
    <div>
      <a href="/">Home</a><a href="https://github.com/toyboot4e">GitHub</a>
    </div>
  </footer>
</body>
</html>
