<!DOCTYPE html>
<html lang="ja"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>ABC 350 - toybeam</title><meta name="description" content="devlog of toyboot4e"/><link rel="stylesheet" href="/style/simple.min.css"/><link rel="stylesheet" href="/style/style.css"/><link rel="stylesheet" href="/style/prism.css"/><script type="text/javascript" async="" src="/style/prism.js"></script><!-- MathJax --><script type="text/javascript" async="" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-MML-AM_CHTML"></script></head><body><header role="banner"><h1>ABC 350</h1><p>Apr 21, 2024</p><nav role="navigation"><a href="/index.html">Home</a><a href="https://github.com/toyboot4e">GitHub</a></nav></header><main role="main">
<h2 id="ABC 350"><a href="#ABC 350">ABC 350</a></h2><p>
<a href="https://atcoder.jp/contests/abc350">ABC 350</a> ã«å‚åŠ ã—ã¾ã—ãŸã€‚<br>
</p>

<h3 id="A å•é¡Œ"><a href="#A å•é¡Œ"><a href="https://atcoder.jp/contests/abc350/tasks/abc350_a">A å•é¡Œ</a></a></h3><p>
æ„šç›´ã«è§£ãã¾ã™ã€‚ 90 bytes..<br>
</p>

<div class="org-src-container">
<pre><code class="src language-hs">main=interact$(\b-&gt;if b then"Yes"else"No").((&amp;&amp;)&lt;$&gt;(`elem`[1..349])&lt;*&gt;(/=316)).read.drop 3
</code></pre>
</div>

<h3 id="B å•é¡Œ"><a href="#B å•é¡Œ"><a href="https://atcoder.jp/contests/abc350/tasks/abc350_b">B å•é¡Œ</a></a></h3><p>
ã§ã‚“ã¦ãƒã™ã¨ã‚ãŠãï¼<br>
</p>

<p>
<code>accumArray</code> ã§è§£ãã®ãŒå …ã„ã§ã™ã€‚ã“ã®å•é¡Œã‚‚ <code>group . sort</code> ã§è§£ã‘ã‚‹ã‚“ã§ã™ã­ã€‚<br>
</p>

<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">B in Haskellï¼Œã‚€ãšã‹ã—ã„ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯çŸ¥ã‚‰ãªã„ã®ã§ã“ã†<br>print $ ( n - ) $ length $ filter odd $ map length $ group $ sort as</p>&mdash; ã¨ãƒ¼ã‚‰ã™ğŸŒ¸ğŸ“¦ğŸŒ•âœ¨ğŸŒ‚ğŸ§ (@torus711) <a href="https://twitter.com/torus711/status/1781685041665548680?ref_src=twsrc%5Etfw">April 20, 2024</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>
ã“ã‚Œã‚’å€Ÿã‚Šã¦ AC ã—ã¾ã™ã€‚ 108 bytes<br>
</p>

<div class="org-src-container">
<pre><code class="src language-hs">import Data.List
main=interact$show.((-).head&lt;*&gt;length.filter(odd.length).group.sort.drop 2).map read.words
</code></pre>
</div>

<h3 id="C å•é¡Œ"><a href="#C å•é¡Œ"><a href="https://atcoder.jp/contests/abc350/tasks/abc350_c">C å•é¡Œ</a></a></h3><p>
é›¢ã‚ŒãŸè¦ç´ ã‚‚å…¥ã‚Œæ›¿ãˆã§ãã¾ã™ã€‚æœ€é©ã§ãªãã¦ã‚‚è‰¯ã„ã®ã§ã€å·¦ã‹ã‚‰é †ç•ªã«å€¤ã‚’ç¢ºå®šã•ã›ã¦è¡Œã‘ã°è‰¯ã„ã§ã™ã€‚å€¤ â†’ æ·»å­—ã¨æ·»å­— â†’ å€¤ã€ä¸¡æ–¹å‘ã®ãƒãƒƒãƒ—ã‚’æŒã£ã¦è§£ãã¾ã™ã€‚<br>
</p>

<p>
ã‚„ã¯ã‚Š <a href="https://atcoder.jp/contests/abc350/submissions/52568385">gksato ã•ã‚“ã®æå‡º</a> ãŒä¸Šæ‰‹ã‹ã£ãŸã§ã™ã€‚<br>
</p>

<ul><li><code>VU.imap (flip (,))</code><br>
å€¤ â†’ æ·»å­—ã®ãƒãƒƒãƒ— (é…åˆ—) ã‚’ç”Ÿæˆã—ã¾ã™ã€‚<br></li>
<li><a href="https://www.stackage.org/haddock/lts-21.6/vector-0.13.0.0/Data-Vector-Generic.html#v:update">VU.update</a><br>
<code>VU.accumulate (const id)</code> ã¨åŒã˜ã§ã™ã€‚<br></li>
<li><code>(`VU.mapMaybeM` VU.generate n id) $ ..</code><br>
å€¤ã®å…¥ã‚Œæ›¿ãˆãŒèµ·ããŸå ´åˆã®ã¿ <code>Just (i, i')</code> ã‚’è¿”ã™ã“ã¨ã§ã€æ“ä½œå±¥æ­´ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚<br></li>
<li><code>VUM.swap</code><br>
é…åˆ—ä¸­ã®å€¤ã®å…¥ã‚Œæ›¿ãˆã‚’è¡Œã„ã¾ã™ã€‚<br></li>
</ul>

<h3 id="D å•é¡Œ"><a href="#D å•é¡Œ"><a href="https://atcoder.jp/contests/abc350/tasks/abc350_d">D å•é¡Œ</a></a></h3><p>
é€£çµæˆåˆ†ã®ä»»æ„ã®é ‚ç‚¹åŒå£«ã®é–“ã«è¾ºãŒå¼•ã‘ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚<br>
</p>

<p>
ç­”ãˆã¯ \(\sum_i {\binom {{é ‚ç‚¹æ•°}_i} {2} - {è¾ºã®æ•°}_i}\) ã§ã™ã€‚é€£çµæˆåˆ†ä¸­ã®è¾ºã®æ•°ã‚’è¿½è·¡ã—ã¤ã¤ã€ Union-Find ã‚’ä½¿ã£ã¦è§£ãã¾ã—ãŸã€‚<br>
</p>

<p>
ã¨ã“ã‚ãŒå¼æ•´ç†ã™ã‚‹ã¨ \(\sum_i {\binom {{é ‚ç‚¹æ•°}_i} {2}} - è¾ºã®æ•°ã®å’Œ\) ã¨ãªã‚‹ãŸã‚ã€ã•ã‚‰ã«æ‰‹æŠœãã§ãã‚‹ã‚ˆã†ã§ã™ã€‚ä»¥ä¸‹ã¨ãªã‚Šã¾ã—ãŸ:<br>
</p>

<div class="org-src-container">
<pre><code class="src language-hs">solve :: StateT BS.ByteString IO ()
solve = do
  (!n, !m) &lt;- ints2'
  !es &lt;- U.replicateM m ints11'

  -- é€£çµæˆåˆ†ã®ãƒªã‚¹ãƒˆã‚’å–å¾—
  let !gr = buildSG (0, n - 1) $ swapDupeU es
  let !res = map length . snd $ allComponentsSG gr

  printBSB $ subtract m $ sum $ map (\v -&gt; v * pred v `div` 2) res
</code></pre>
</div>

<h3 id="E å•é¡Œ"><a href="#E å•é¡Œ"><a href="https://atcoder.jp/contests/abc350/tasks/abc350_e">E å•é¡Œ</a></a></h3><p>
ãƒˆãƒãƒ­ã‚¸ã‚«ãƒ«é †ã«ç­”ãˆã‚’æ±‚ã‚ã‚‹ã®ãŒç„¡ç†ãã†ã§ã€è«¦ã‚ã¦ F ã«è¡Œãã¾ã—ãŸã€‚<br>
</p>

<p>
ãƒ¡ãƒ¢åŒ–å†å¸°ã§è§£ã‘ã‚‹ã‚ˆã†ã§ã™ã€‚ãã†ã˜ã‚ƒã‚“â€¦â€¦ï¼<br>
</p>

<div class="org-src-container">
<pre><code class="src language-hs">solve :: StateT BS.ByteString IO ()
solve = do
  (!n, !a, !x, !y) &lt;- ints4'

  let calc :: Int -&gt; IM.IntMap Double -&gt; (Double, IM.IntMap Double)
      calc i im = case IM.lookup i im of
        Just cached -&gt; (cached, im)
        Nothing -&gt; runState (calcDp i) im
      calcDp :: Int -&gt; State (IM.IntMap Double) Double
      calcDp i = do
        !e1 &lt;- (intToDouble x +) &lt;$&gt; state (calc (i `div` a))
        -- E[i] = \sum_j {1/6 (y + E[i/j])}_{1..6}
        -- E[i] = 1/5 (6y + \sum_j {E[i/j]}_{1..5})
        !e2 &lt;- do
          !k2 &lt;- state (calc (i `div` 2))
          !k3 &lt;- state (calc (i `div` 3))
          !k4 &lt;- state (calc (i `div` 4))
          !k5 &lt;- state (calc (i `div` 5))
          !k6 &lt;- state (calc (i `div` 6))
          return $ (intToDouble y * 6.0 + k2 + k3 + k4 + k5 + k6) / 5.0
        let !e = min e1 e2
        modify' $ IM.insert i e
        return e

  printBSB $ fst $ calc n $ IM.singleton 0 0.0
</code></pre>
</div>

<p>
åå°„ã§è§£ã‘ã‚‹å•é¡Œã—ã‹è§£ã‘ãªã„ã®ãŒèª²é¡Œã§ã™ã€‚<br>
</p>

<h3 id="F å•é¡Œ"><a href="#F å•é¡Œ"><a href="https://atcoder.jp/contests/abc350/tasks/abc350_f">F å•é¡Œ</a></a></h3><p>
ã‚‚ã…ï¾ï¾ï¾ç„¡ç†ã€‚ã€‚<br>
</p>

<h2 id="Misc"><a href="#Misc">Misc</a></h2><h3 id="æ±ç”¨ Dijkstra"><a href="#æ±ç”¨ Dijkstra">æ±ç”¨ Dijkstra</a></h3><p>
é‡ã• <code>w</code> ã®åˆ¶ç´„ã‚’ <code>(U.Unbox w, Monoid w, Ord w)</code> ã«ã™ã‚‹ã®ãŒæ±ç”¨æ€§ãŒã‚ã£ã¦è‰¯ã•ãã†ã§ã™ã€‚ <code>Sum Int</code>, <code>Max Int</code>, <code>Down (Sum Int)</code> ãªã©â€¦â€¦<br>
</p>
</main><footer role="contentinfo"><p>Styled with <a href="https://simplecss.org/">Simple.css</a></p><div><a href="/index.html">Home</a><a href="https://github.com/toyboot4e">GitHub</a></div></footer></body></html>
