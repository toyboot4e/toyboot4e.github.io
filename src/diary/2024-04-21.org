#+TITLE: ABC 350
#+DATE: <2024-04-21 Sun>

* ABC 350

[[https://atcoder.jp/contests/abc350][ABC 350]] ã«å‚åŠ ã—ã¾ã—ãŸã€‚

** [[https://atcoder.jp/contests/abc350/tasks/abc350_a][A å•é¡Œ]]

æ„šç›´ã«è§£ãã¾ã™ã€‚ 90 bytes..

#+BEGIN_SRC hs
main=interact$(\b->if b then"Yes"else"No").((&&)<$>(`elem`[1..349])<*>(/=316)).read.drop 3
#+END_SRC

** [[https://atcoder.jp/contests/abc350/tasks/abc350_b][B å•é¡Œ]]

ã§ã‚“ã¦ãƒã™ã¨ã‚ãŠãï¼

=accumArray= ã§è§£ãã®ãŒå …ã„ã§ã™ã€‚ã“ã®å•é¡Œã‚‚ =group . sort= ã§è§£ã‘ã‚‹ã‚“ã§ã™ã­ã€‚

#+BEGIN_EXPORT html
<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">B in Haskellï¼Œã‚€ãšã‹ã—ã„ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯çŸ¥ã‚‰ãªã„ã®ã§ã“ã†<br>print $ ( n - ) $ length $ filter odd $ map length $ group $ sort as</p>&mdash; ã¨ãƒ¼ã‚‰ã™ğŸŒ¸ğŸ“¦ğŸŒ•âœ¨ğŸŒ‚ğŸ§ (@torus711) <a href="https://twitter.com/torus711/status/1781685041665548680?ref_src=twsrc%5Etfw">April 20, 2024</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
#+END_EXPORT

ã“ã‚Œã‚’å€Ÿã‚Šã¦ AC ã—ã¾ã™ã€‚ 108 bytes

#+BEGIN_SRC hs
import Data.List
main=interact$show.((-).head<*>length.filter(odd.length).group.sort.drop 2).map read.words
#+END_SRC

** [[https://atcoder.jp/contests/abc350/tasks/abc350_c][C å•é¡Œ]]

é›¢ã‚ŒãŸè¦ç´ ã‚‚å…¥ã‚Œæ›¿ãˆã§ãã¾ã™ã€‚æœ€é©ã§ãªãã¦ã‚‚è‰¯ã„ã®ã§ã€å·¦ã‹ã‚‰é †ç•ªã«å€¤ã‚’ç¢ºå®šã•ã›ã¦è¡Œã‘ã°è‰¯ã„ã§ã™ã€‚å€¤ â†’ æ·»å­—ã¨æ·»å­— â†’ å€¤ã€ä¸¡æ–¹å‘ã®ãƒãƒƒãƒ—ã‚’æŒã£ã¦è§£ãã¾ã™ã€‚

ã‚„ã¯ã‚Š [[https://atcoder.jp/contests/abc350/submissions/52568385][gksato ã•ã‚“ã®æå‡º]] ãŒä¸Šæ‰‹ã‹ã£ãŸã§ã™ã€‚

- =VU.imap (flip (,))=
  å€¤ â†’ æ·»å­—ã®ãƒãƒƒãƒ— (é…åˆ—) ã‚’ç”Ÿæˆã—ã¾ã™ã€‚
- [[https://www.stackage.org/haddock/lts-21.6/vector-0.13.0.0/Data-Vector-Generic.html#v:update][VU.update]]
  =VU.accumulate (const id)= ã¨åŒã˜ã§ã™ã€‚
- =(`VU.mapMaybeM` VU.generate n id) $ ..=
  å€¤ã®å…¥ã‚Œæ›¿ãˆãŒèµ·ããŸå ´åˆã®ã¿ =Just (i, i')= ã‚’è¿”ã™ã“ã¨ã§ã€æ“ä½œå±¥æ­´ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚
- =VUM.swap=
  é…åˆ—ä¸­ã®å€¤ã®å…¥ã‚Œæ›¿ãˆã‚’è¡Œã„ã¾ã™ã€‚

** [[https://atcoder.jp/contests/abc350/tasks/abc350_d][D å•é¡Œ]]

é€£çµæˆåˆ†ã®ä»»æ„ã®é ‚ç‚¹åŒå£«ã®é–“ã«è¾ºãŒå¼•ã‘ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚

ç­”ãˆã¯ $\sum_i {\binom {{é ‚ç‚¹æ•°}_i} {2} - {è¾ºã®æ•°}_i}$ ã§ã™ã€‚é€£çµæˆåˆ†ä¸­ã®è¾ºã®æ•°ã‚’è¿½è·¡ã—ã¤ã¤ã€ Union-Find ã‚’ä½¿ã£ã¦è§£ãã¾ã—ãŸã€‚

ã¨ã“ã‚ãŒå¼æ•´ç†ã™ã‚‹ã¨ $\sum_i {\binom {{é ‚ç‚¹æ•°}_i} {2}} - è¾ºã®æ•°ã®å’Œ$ ã¨ãªã‚‹ãŸã‚ã€ã•ã‚‰ã«æ‰‹æŠœãã§ãã‚‹ã‚ˆã†ã§ã™ã€‚ä»¥ä¸‹ã¨ãªã‚Šã¾ã—ãŸ:

#+BEGIN_SRC hs
solve :: StateT BS.ByteString IO ()
solve = do
  (!n, !m) <- ints2'
  !es <- U.replicateM m ints11'

  -- é€£çµæˆåˆ†ã®ãƒªã‚¹ãƒˆã‚’å–å¾—
  let !gr = buildSG (0, n - 1) $ swapDupeU es
  let !res = map length . snd $ allComponentsSG gr

  printBSB $ subtract m $ sum $ map (\v -> v * pred v `div` 2) res
#+END_SRC

** [[https://atcoder.jp/contests/abc350/tasks/abc350_e][E å•é¡Œ]]

ãƒˆãƒãƒ­ã‚¸ã‚«ãƒ«é †ã«ç­”ãˆã‚’æ±‚ã‚ã‚‹ã®ãŒç„¡ç†ãã†ã§ã€è«¦ã‚ã¦ F ã«è¡Œãã¾ã—ãŸã€‚

ãƒ¡ãƒ¢åŒ–å†å¸°ã§è§£ã‘ã‚‹ã‚ˆã†ã§ã™ã€‚ãã†ã˜ã‚ƒã‚“â€¦â€¦ï¼

#+BEGIN_SRC hs
solve :: StateT BS.ByteString IO ()
solve = do
  (!n, !a, !x, !y) <- ints4'

  let calc :: Int -> IM.IntMap Double -> (Double, IM.IntMap Double)
      calc i im = case IM.lookup i im of
        Just cached -> (cached, im)
        Nothing -> runState (calcDp i) im
      calcDp :: Int -> State (IM.IntMap Double) Double
      calcDp i = do
        !e1 <- (intToDouble x +) <$> state (calc (i `div` a))
        -- E[i] = \sum_j {1/6 (y + E[i/j])}_{1..6}
        -- E[i] = 1/5 (6y + \sum_j {E[i/j]}_{1..5})
        !e2 <- do
          !k2 <- state (calc (i `div` 2))
          !k3 <- state (calc (i `div` 3))
          !k4 <- state (calc (i `div` 4))
          !k5 <- state (calc (i `div` 5))
          !k6 <- state (calc (i `div` 6))
          return $ (intToDouble y * 6.0 + k2 + k3 + k4 + k5 + k6) / 5.0
        let !e = min e1 e2
        modify' $ IM.insert i e
        return e

  printBSB $ fst $ calc n $ IM.singleton 0 0.0
#+END_SRC

åå°„ã§è§£ã‘ã‚‹å•é¡Œã—ã‹è§£ã‘ãªã„ã®ãŒèª²é¡Œã§ã™ã€‚

** [[https://atcoder.jp/contests/abc350/tasks/abc350_f][F å•é¡Œ]]

ã‚‚ã…ï¾ï¾ï¾ç„¡ç†ã€‚ã€‚

* Misc

** æ±ç”¨ Dijkstra

é‡ã• =w= ã®åˆ¶ç´„ã‚’ =(U.Unbox w, Monoid w, Ord w)= ã«ã™ã‚‹ã®ãŒæ±ç”¨æ€§ãŒã‚ã£ã¦è‰¯ã•ãã†ã§ã™ã€‚ =Sum Int=, =Max Int=, =Down (Sum Int)= ãªã©â€¦â€¦

